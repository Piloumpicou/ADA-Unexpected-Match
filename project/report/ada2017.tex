%
% File acl2014.tex
%
% Contact: giovanni.colavizza@epfl.ch
%%
%% Based on the style files for ACL-2013, which were, in turn,
%% Based on the style files for ACL-2012, which were, in turn,
%% based on the style files for ACL-2011, which were, in turn, 
%% based on the style files for ACL-2010, which were, in turn, 
%% based on the style files for ACL-IJCNLP-2009, which were, in turn,
%% based on the style files for EACL-2009 and IJCNLP-2008...

%% Based on the style files for EACL 2006 by 
%%e.agirre@ehu.es or Sergi.Balari@uab.es
%% and that of ACL 08 by Joakim Nivre and Noah Smith

\documentclass[11pt]{article}
\usepackage{acl2014}
\usepackage{times}
\usepackage{url}
\usepackage[hidelinks]{hyperref}
\usepackage{latexsym}

\usepackage{graphicx}	% For figure environment
\usepackage{caption}
\usepackage{subcaption}
\usepackage[font=scriptsize]{subcaption}
\usepackage[font=scriptsize]{caption}

\PassOptionsToPackage{hyphens}{url}

\renewcommand\_{\textunderscore\allowbreak}

%\setlength\titlebox{5cm}

% You can expand the titlebox if you need extra space
% to show all the authors. Please do not make the titlebox
% smaller than 5cm (the original size); we will check this
% in the camera-ready version and ask you to change it back.

\title{2018's Best Hit Recipe}

\author{Jean-Thomas Furrer \\
  {\small\tt jean-thomas.furrer@epfl.ch} \\\And
  Benjamin Girard \\
  {\small\tt benjamin.girard@epfl.ch} \\\And
  Emily Hentgen \\
{\small\tt emily.hentgen@epfl.ch} \\}

\date{}

\begin{document}
\maketitle
\begin{abstract}
%plouf
\end{abstract}


\section{Introduction}
The Million Song Dataset is a collaboration between the LabROSA and The Echo Nest, and compiles the audio features and metadata for a million popular contemporary tracks. The whole dataset, about 280 GB, was released in 2011, and is freely available. 

In this project, we analysed a few high level features such as the song duration, the artist popularity and country of origin, as well as the music genre. 
Using the related musiXmatch dataset further allowed us to perform an analysis of the lyrics.

We briefly present some related work in section 2, and explain how the data was collected in section 3. Section 4 gives an overview of the datasets, and the results of the analysis are presented in sections 5. Finally, we conclude in section 6.

\section{Related work}
%?
We can find some projet made by student like us, To predict the best sound of the Millon song dataset : 

http://cs229.stanford.edu/proj2013/NtwariNshutiSoria-WhatWillBeYourFavoriteSongLetMeTellYou.pdf
http://cs229.stanford.edu/proj2014/Angela%20Xue,%20Nick%20Dupoux,%20Predicting%20the%20Commercial%20Success%20of%20Songs%20Based%20on%20Lyrics%20and%20Other%20Metrics.pdf
http://cs229.stanford.edu/proj2015/140_report.pdf
http://cs229.stanford.edu/proj2015/145_report.pdf
https://github.com/thomasSve/Million-Song-Dataset-Analysis/blob/master/report/song-popularity-prediction.pdf
https://bcourses.berkeley.edu/files/65096715/download?...frd...

However this work are more focused on the machine learning part, try to find one model to predict the hotness.
In this projet we will be more focus to find the main componant of hotness.

\section{Data collection}
The analysis is based on two different datasets: the Million Song Dataset (MSD), containing records for 1 000 000 contemporary songs, and the musiXmatch dataset, which contains bag-of-words lyrics for 237 662 out of 1 000 000 songs.

\subsection{The Million Song Dataset}
Initially, we gained insight into the dataset by working with the official MSD subset which covers 10 000 songs, freely available for download at \url{https://labrosa.ee.columbia.edu/millionsong/pages/getting-dataset}.
We then moved to the full dataset of 1 000 000 songs; however, the analysis only uses a subset of it,  because we drop entries with undefined value for the \texttt{song hotttnesss} (\texttt{NaN}).
In the end, we worked on a subset of XXX XXX songs.

We retrieved the data from the whole dataset, made available on the ADA cluster, as single json file. Beforehand, we drop entries we decided to not analyse. 
This significantly reduces the size of the data, so that the subsequent analysis could be performed locally.

\subsection{The musiXmatch dataset}
The musiXmatch dataset can directly retrieved from \url{https://labrosa.ee.columbia.edu/millionsong/musixmatch}
There are four different files: 
\texttt{full\_word\_list.txt} (7 MB) containing the complete list of distinct words in the collected lyrics, \texttt{mxm\_779k\_matches.txt} (85 MB) containing the \texttt{track id}, \texttt{artist name} and \texttt{title} for both MSD and the musiXmatch dataset, \texttt{mxm\_dataset\_train.txt} (100 MB) and \texttt{mxm\_dataset\_test.txt} (13 MB), for which each record contains an MSD \texttt{track id}, a musiXmatch \texttt{track id} and a dictionary mapping word ids of the top-5000 most frequent words to the number of occurrences for this song.
We use the train set and test set as single dataset, since our analysis is no prediction task per se.

The correspondence between the MSD and the musiXmatch dataset is made through the \texttt{track id}s of a song.
We could match 154 663 tracks with the \texttt{mxm\_779k\_matches} dataset (779 056 songs in total), but in the end, out of 159 430 songs, only 60 146 songs could be matched with the concatenation of the \texttt{mxm\_dataset\_test} and the \texttt{mxm\_dataset\_train} datasets.

\section{Dataset description}
%summary statistics, maths, main algorithms
Each record of the MSD contains 55 fields.
For our analysis, we retrieved only a subset of these fields, namely \texttt{song id}, \texttt{track id}, \texttt{title}, \texttt{year}, \texttt{duration}, \texttt{song hotttnesss}, \texttt{danceability}, \texttt{energy} (song-related features) \texttt{artist id}, \texttt{artist name}, \texttt{artist terms}, \texttt{terms weight}, \texttt{artist latitude},  \texttt{artist longitude}, \texttt{artist location} and \texttt{artist hotttnesss} (artist-related features) 
(it turned out however that none of the songs had their \texttt{energy} or \texttt{danceability} fields defined, i.e. not set to 0.0).
What is more, we dropped all entries whose \texttt{song hotttnesss} was \texttt{NaN}.

\subsection{Release year}
The MSD was put together in 2010
The oldest songs in the dataset dates back to 1925, but most songs were sampled between 1995 and 2010.

\begin{figure}[h!]
\centering
\captionsetup{width=1.0\textwidth}
\includegraphics[trim={2.5cm 0cm 0cm 1cm},clip, scale=0.26]{images/"release_year_distribution".png}
\caption{Release years distribution}
\label{fig:song_duration}
\end{figure}

\subsection{Song hotttnesss}
Our metric for measuring the popularity of a song based on the \texttt{song hotttnesss} field of a song, value between 0.0 and 1.0, according to the Echo Nest in December 2010, when the dataset was compiled.
Since the \texttt{song hotttnesss} fields can be \texttt{NaN}, it remains unclear whether a value of 0.0 corresponds to a nonexistent \texttt{song hotttnesss}, or if the feature has not been evaluated for this song.

In Figure \ref{fig:song_hotttnesss_distribution}, we plot the \texttt{song hotttnesss} distribution rounded to 2 decimals, excluding 0 values. 
The shape of this distribution is rather unusual: the right part of the curve is smooth, while the left one is completely erratic.

\begin{figure}[h!]
\centering
\captionsetup{width=1.0\textwidth}
\includegraphics[trim={2.5cm 0cm 0cm 1cm},clip, scale=0.26]{images/"song_hotttnesss_distribution".png}
\caption{Song hotttnesss distribution}
\label{fig:song_hotttnesss_distribution}
\end{figure}

\subsection{Artist's country of origin}
Matched coordinates to country using reverse geolocation (\texttt{pygeocoder} and \texttt{pygeolib} packages) (35 106 songs with valid coordinates)

Among those songs, there is an unequal repartition between the different countries.
An overwhelming majority of songs comes from the United States (20 276), followed by the United Kingdom (4 831), but the number goes down to a single song for Afghanistan, China and Bolivia.


\section{Results and findings}


\subsection{Artist popularity}
There is a correlation between the \texttt{song\_hotttnesss} and the corresponding artist's \texttt{artist\_hotttnesss}.
Hot songs tend to be associated to hot artist, but it turns out the hotttessst artists do not make the hotttessst songs.
Notice that the gap between 0.0 and 0.2: as mentioned before, almost no song has a \texttt{song\_hotttnesss} below 0.2.

\begin{figure}[h!]
\centering
\captionsetup{width=1.0\textwidth}
\includegraphics[trim={2cm 4cm 2cm 2cm},clip, scale=0.3]{images/"artist_hotttnesss_vs_song_hotttnesss".png}
\caption{Artist hotttnesss compared to the average song hotttnesss}
\label{fig:artist_hotttnesss}
\end{figure}

\subsection{Song duration}
Despite some outliers - the shortest and longest "songs" are 0.67 seconds respectively 3007 seconds (50min 7s) long - close to 75\% (73.47\%) of the songs are 2 to 5 minutes long, a very common duration for contemporary music tracks.

\begin{figure}[h!]
\centering
\captionsetup{width=1.0\textwidth}
\includegraphics[trim={0cm 0cm 0cm 0cm},clip, scale=0.26]{images/"song_duration_vs_song_hotttnesss".png}
\caption{Song duration against song hotttnesss}
\label{fig:song_duration}
\end{figure}

Figure \ref{fig:song_duration_over_years} displays the average song duration for different threshold intervals from 1925 to 2010. 
Unfortunately, as can be seen by the very irregular values before 1960, there is most likely not enough data before 1960 to make any reasonable conclusion regarding that period. 
We can nonetheless make the following observations:
\begin{enumerate}
\itemsep 0mm
\item The top songs have a duration in a tight interval
\item Over the years, the average song duration of the top songs displays less and less variations
\item In the last years, the average top songs duration dropped below the other average song durations
\end{enumerate}

This suggests that in order to be rated "hot", songs tend to comply more and more to a standard duration.

\begin{figure}[h!]
\centering
\captionsetup{width=1.0\textwidth}
\includegraphics[trim={0cm 0cm 0cm 0cm},clip, scale=0.26]{images/"song_duration_average_over_years".png}
\caption{Average song duration evoluation over the years}
\label{fig:song_duration_over_years}
\end{figure}

\subsection{Music genre}
This analysis is based on the \texttt{artist terms} of a song, which can be seen as music genre tags given by the Echo Nest.
There are at least 6 482 distinct \texttt{artist terms} used in the MSD, including all possible variations such as "rap rock", "funk rock", funk rap", "jazz funk", "jazz rap" or "jazz rock".
Actually, the most recurrent \texttt{artist terms} do correspond to music genres, while the least common ones, used for a single song for instance, are more like miscellaneous tags.
The dataset is largely dominated by the rock, pop and electronic genre.

In order to determine which music genres are the most popular, we weighted all the \texttt{artist terms} of songs with a \texttt{song hotttnesss} greater or equal to 0.9 by their corresponding \texttt{artist term weights}. 
We then normalized the result, to obtain the "proportion" of the most popular music genres.
For a lower threshold, the ranking is essentially very similar: only the weights decrease, since more songs are included, and hence more \texttt{artist terms} as well.
%Ideally, group artist terms together, but not obvious how to do that

%\begin{tabular}{|lr|}
%\hline
%\texttt{artist\_terms} & occurrences\\
%\hline
%rock               & 131337\\
%pop                 & 98814\\
%electronic          & 96684\\
%alternative rock    & 75882\\
%alternative         & 69619\\
%indie               & 62706\\
%hip hop             & 58751\\
%jazz                & 57699\\
%indie rock          & 57193\\
%united states       & 55522\\
%pop rock            & 53863\\ 
%punk                & 53043\\
%\hline
%\end{tabular}
%\captionof{table}{Top-12 \texttt{artist\_terms} (non-weighted)}


\begin{tabular}{|lrr|}
\hline
\texttt{artist\_terms} & weight (\%) & occurrences\\
\hline
rock 				& 4.617761 &	426\\
pop 				& 3.738941 &	409\\
alternative 		& 2.493392 &	264\\
indie 				& 2.221263 &	256\\
alternative rock 	& 2.011225 &	188\\
guitar 				& 1.987991 &	308\\
indie rock 			& 1.904490 &	163\\
acoustic 			& 1.577093 &	231\\
electronic 			& 1.488118 &	182\\
soundtrack 			& 1.482128 &	172\\
soul 				& 1.328866 &	180\\
classic rock 		& 1.181799 &	116\\
punk 				& 1.166998 &	149\\
\hline
\end{tabular}
\captionof{table}{Top-12 \texttt{artist\_terms} (weighted) for a \texttt{song\_hotttnesss} threshold of 0.9 (500 songs), and a minimum number of occurrences of 0}


 	
\subsection{Lyrics}
Initially, we analysed the lyrics by considering all the words in the top-5000 list of the musiXmatch dataset. In a second step, we exclude the stopwords from the analysis.

\subsubsection{With stopwords}
The main observation resulting from this analysis is that the frequency of English words in lyrics differ from the frequency of English words in prose, particularly regarding the use of pronouns.
While 'the' is the number one word in term of frequency in English prose, it is "only" ranked third for a \texttt{song threshold} greater than 0.8, behind 'I' and 'you', which are 11th respectively 14th in English prose.

The popular songs hence seem to be rather about 'I', 'you' and 'we', and less about 'they' or 'it'.
Although 'it' has a stable ranking of 8th against 11th in English prose, 'they' (ranked 26st in English prose) in fact systematically scores lower than 'we' (ranked 27th in English prose) in the lyrics.

In Figure \ref{fig:word_frequency_stopwords}, we show the frequency of the English pronouns in the lyrics as a function of the \texttt{song hotttnesss} threshold.
We also plot the frequency of the stopword 'the', whose evolution we expect does not very much across songs, independently of their popularity, and which can then serve as a baseline.
Interestingly, while the frequency of 'I' and 'we' keeps increasing, the one for 'you' suddenly drops past a \texttt{song hotttnesss} threshold of 0.9.

%notice did not count contractions of pronouns and verbs such as 'you'll', 'you've' etc.

\begin{figure}[h!]
\centering
\captionsetup{width=1.0\textwidth}
\includegraphics[trim={0cm 0cm 0cm 0cm},clip, scale=0.26]{images/"word_frequency_vs_song_hotttnesss".png}
\caption{Pronouns frequency for different \texttt{song hotttnesss} thresholds}
\label{fig:word_frequency_stopwords}
\end{figure}

\subsubsection{Without stopwords}
It is not always obvious to determine whether a word is a stopword or not. We heuristically compiled a list of stopwords using the freely-available lists of stopwords at \url{https://www.ranks.nl/stopwords} and \url{http://www.lextek.com/manuals/onix/stopwords1.html}.

When ignoring the stopwords in the ranking, we can point out three characteristics that we tend to encounter in popular songs (although these are typically not present all at the same time in hot rated songs):
\begin{enumerate}
\itemsep 0mm
\item The presence of the specific words 'love', 'time' and 'feel', which actually keep ranking among the top places for high \texttt{song hotttnesss} thresholds as well as low ones
\item The non-negligible use of the interjections 'yeah' and 'oh' (although the frequency of 'oh' drops above a threshold of 0.9)
\item The use of informal speech like 'gonna', strengthened by the fact that it is often found together with 'yeah'
\end{enumerate}
While 'yeah', oh' or 'gonna' could actually also be considered as stopwords, it is interesting to see they are the second "type" of words to rank top, after the stopwords.

\subsubsection{Language and country of origin}
More than 60\% of the songs come from countries of Anglo-Saxon culture (United States, United Kingdom, Canada, Australia, ...). As a consequence, the vast majority of lyrics are written in English, so that words of different languages tend to be eclipsed in the analysis.
Even after removing the English stopwords, the top ranked words are still English words.

However, we also suggest this does not simply reflect the fact that much more songs were sampled from these countries, but also a general trend which can be observed when it comes to popular songs.
The country of origin of the artist indeed does not necessarily match the language in which the lyrics were written.
By checking the top songs from non Anglo-Saxon countries such as Sweden, Denmark or Greece, it turns out the lyrics are actually written in English, not in Swedish, Danish or Greek.
A few of the top songs have Spanish lyrics, but these songs are still a minority though.

%intersection
%example of Hungarian?


%Most words present only in low rated songs are actually non-English words. This also raises the question on how the song hotttnesss was evaluated by the Echo Nest; population may tend to rate English songs rather than non English ones

	
\section{Conclusions}

MSD: unequal distribution of songs regarding countries
musiXmatch limitations: bag-of-words (due to copyright issues)





\begin{thebibliography}{}

\bibitem[\protect\citename{MSD official documentation}]{MSD}
\url{https://labrosa.ee.columbia.edu/millionsong}

\bibitem[\protect\citename{List of stopwords}]{list_stopwords}
\url{https://www.ranks.nl/stopwords}\\
\url{http://www.lextek.com/manuals/onix/stopwords1.html}.


\end{thebibliography}

\end{document}
